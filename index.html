<!DOCTYPE html>
<html>
    <head>
        <title>awpd ▄︻デ══━一</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body style="margin: 0px; height: 100%; background-color: rgb(14, 14, 14); margin: 0; padding: 0; display: flex; justify-content: center; align-items: center; height: 100vh; overflow: hidden;">
        <canvas id="combinedCanvas" style="max-width: 100%; max-height: 100%; width: auto; height: auto;" width="588" height="735"></canvas>
        <script>
            function getParameterByName(name, url) {
                if (!url) url = window.location.href;
                name = name.replace(/[\[\]]/g, "\\$&");
                var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
                results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, " "));
            }
            var db_token = [
                ["0x5af0d9827e0c53e4799bb226655a1de152a425a5", "https://www.miladymaker.net/milady/", ".png", 10000, ["https://i.ibb.co/CJFR0Lx/awp-for-milady.png"]]
            ];
            var _tokenAddress = getParameterByName('a');
            var _tokenID = getParameterByName('q');
            var _skinID = getParameterByName('g');
            var tokenAddress;
            var tokenID;
            var skinID;
            var rngAddress = Math.floor(Math.random() * db_token.length);
            var rngSkin = Math.floor(Math.random() * db_token[rngAddress][4].length);
            var rngToken = Math.floor(Math.random() * db_token[rngAddress][3]);
            if (_tokenAddress = 0) {
                tokenAddress = _rngAddress;
                tokenID = rngToken;
                skinID = rngSkin;
            } else {
                tokenAddress = tokenAddress;
                tokenID = tokenID;
                skinID = skinID;
            }
            console.log(rngAddress, rngSkin, rngToken);
            for (var i = 0; i < db_token.length; i++) {
                if (db_token[i][0] === tokenAddress) {
                    var tokenTemplate = db_token[i][1] + tokenID + db_token[i][2];
                    var skinTemplate = db_token[i][4][0 + parseInt(skinID)];
                    var canvas = document.getElementById('combinedCanvas');
                    var ctx = canvas.getContext('2d');
                    var img1 = new Image();
                    img1.src = tokenTemplate;
                    var img2 = new Image();
                    img2.src = skinTemplate;
                    function drawImages() {
                        if (img1.complete && img2.complete) {
                            ctx.drawImage(img1, 0, 0, canvas.width, canvas.height);
                            ctx.drawImage(img2, 0, 0, canvas.width, canvas.height);
                        } else {
                            img1.onload = img2.onload = function() {
                               drawImages();
                            };
                        }
                    }
                    drawImages();
                    break; 
                }
            }
            </script>
    </body>
</html>
